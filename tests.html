<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>–¢–µ—Å—Ç: –ü—Ä–æ–∏–∑–≤–æ–¥–Ω—ã–µ —Å–ª–æ–∂–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π</title>
  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script id="MathJax-script" async
    src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

  <style>
    :root {
      --primary: #4361ee;
      --primary-dark: #3a56d4;
      --secondary: #7209b7;
      --success: #06d6a0;
      --danger: #ef476f;
      --warning: #ffd166;
      --light: #f8f9fa;
      --dark: #212529;
      --gray: #6c757d;
      --border-radius: 12px;
      --shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      --transition: all 0.3s ease;
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
      margin: 0;
      padding: 20px;
      min-height: 100vh;
      color: var(--dark);
    }

    .container {
      max-width: 900px;
      margin: 0 auto;
      background: white;
      border-radius: var(--border-radius);
      box-shadow: var(--shadow);
      padding: 25px;
      position: relative;
      overflow: hidden;
    }

    .header {
      text-align: center;
      margin-bottom: 25px;
      padding-bottom: 15px;
      border-bottom: 2px solid var(--light);
      position: relative;
    }

    h1 {
      color: var(--primary);
      margin-bottom: 10px;
      font-size: 28px;
    }

    .description {
      color: var(--gray);
      font-size: 16px;
      margin-bottom: 15px;
    }

    .timer-container {
      display: inline-block;
      background: var(--light);
      padding: 8px 15px;
      border-radius: 30px;
      font-weight: bold;
      color: var(--primary);
      box-shadow: var(--shadow);
    }

    .timer-warning {
      color: var(--danger);
    }

    .progress-container {
      margin-bottom: 25px;
    }

    .progress-bar {
      height: 10px;
      background-color: #e9ecef;
      border-radius: 5px;
      overflow: hidden;
    }

    .progress {
      height: 100%;
      background-color: var(--primary);
      width: 0%;
      transition: var(--transition);
    }

    .progress-text {
      display: flex;
      justify-content: space-between;
      margin-top: 5px;
      font-size: 14px;
      color: var(--gray);
    }

    .question {
      background: var(--light);
      border-radius: var(--border-radius);
      box-shadow: var(--shadow);
      padding: 20px;
      margin-bottom: 20px;
      transition: var(--transition);
      border-left: 4px solid var(--primary);
    }

    .question:hover {
      transform: translateY(-3px);
      box-shadow: 0 6px 12px rgba(0,0,0,0.1);
    }

    .question p {
      font-size: 18px;
      margin-bottom: 15px;
      color: var(--dark);
      font-weight: 500;
    }

    .options {
      display: grid;
      grid-gap: 10px;
    }

    .option {
      display: flex;
      align-items: center;
      padding: 12px 15px;
      background: white;
      border-radius: 8px;
      cursor: pointer;
      transition: var(--transition);
      border: 1px solid #ddd;
    }

    .option:hover {
      background: #f1f3ff;
      border-color: var(--primary);
    }

    .option input {
      margin-right: 12px;
      cursor: pointer;
    }

    .option.selected {
      background: #e6eeff;
      border-color: var(--primary);
    }

    .buttons {
      display: flex;
      justify-content: center;
      gap: 15px;
      margin-top: 30px;
    }

    button {
      padding: 14px 28px;
      font-size: 16px;
      border-radius: 8px;
      cursor: pointer;
      transition: var(--transition);
      border: none;
      font-weight: 600;
    }

    #submitBtn {
      background-color: var(--primary);
      color: white;
      box-shadow: 0 4px 14px rgba(67, 97, 238, 0.4);
    }

    #submitBtn:hover {
      background-color: var(--primary-dark);
      transform: translateY(-2px);
    }

    #resetBtn {
      background-color: white;
      color: var(--primary);
      border: 1px solid var(--primary);
    }

    #resetBtn:hover {
      background-color: #f8f9ff;
      transform: translateY(-2px);
    }

    .result {
      margin-top: 30px;
      text-align: center;
      font-size: 18px;
      background: white;
      padding: 25px;
      border-radius: var(--border-radius);
      box-shadow: var(--shadow);
      display: none;
    }

    .score {
      font-size: 24px;
      font-weight: bold;
      color: var(--primary);
      margin-bottom: 15px;
    }

    .feedback {
      margin-bottom: 20px;
      line-height: 1.6;
    }

    .detailed-results {
      text-align: left;
      margin-top: 20px;
      border-top: 1px solid #eee;
      padding-top: 20px;
    }

    .result-item {
      margin-bottom: 15px;
      padding: 15px;
      border-radius: 8px;
      background: #f9f9f9;
    }

    .correct {
      border-left: 4px solid var(--success);
    }

    .incorrect {
      border-left: 4px solid var(--danger);
    }

    .explanation {
      font-size: 14px;
      color: var(--gray);
      margin-top: 8px;
    }

    .math-expression {
      font-size: 18px;
      margin: 10px 0;
      padding: 8px 12px;
      background: #f8f9fa;
      border-radius: 6px;
      display: inline-block;
      border: 1px solid #e9ecef;
    }

    .user-answer, .correct-answer {
      display: flex;
      align-items: center;
      margin: 8px 0;
    }

    .answer-icon {
      margin-right: 10px;
      font-weight: bold;
    }

    .correct-icon {
      color: var(--success);
    }

    .incorrect-icon {
      color: var(--danger);
    }

    @media (max-width: 768px) {
      .container {
        padding: 15px;
      }
      
      h1 {
        font-size: 24px;
      }
      
      .question {
        padding: 15px;
      }
      
      .buttons {
        flex-direction: column;
      }
      
      button {
        width: 100%;
      }
      
      .math-expression {
        font-size: 16px;
        overflow-x: auto;
        max-width: 100%;
      }
    }

    @media (max-width: 480px) {
      body {
        padding: 10px;
      }
      
      .question p {
        font-size: 16px;
      }
      
      .option {
        padding: 10px;
      }
    }

    /* –ê–Ω–∏–º–∞—Ü–∏–∏ */
    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }
    
    .fade-in {
      animation: fadeIn 0.5s ease-in;
    }
    
    @keyframes pulse {
      0% { transform: scale(1); }
      50% { transform: scale(1.02); }
      100% { transform: scale(1); }
    }
    
    .pulse {
      animation: pulse 0.5s ease;
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>–¢–µ—Å—Ç: –ü—Ä–æ–∏–∑–≤–æ–¥–Ω—ã–µ —Å–ª–æ–∂–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π</h1>
      <p class="description">–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–≤–æ–∏ –∑–Ω–∞–Ω–∏—è –≤ –¥–∏—Ñ—Ñ–µ—Ä–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–º –∏—Å—á–∏—Å–ª–µ–Ω–∏–∏</p>
      <div class="timer-container">
        ‚è≥ –û—Å—Ç–∞–ª–æ—Å—å –≤—Ä–µ–º–µ–Ω–∏: <span id="timer">40:00</span>
      </div>
    </div>
    
    <div class="progress-container">
      <div class="progress-bar">
        <div class="progress" id="progress"></div>
      </div>
      <div class="progress-text">
        <span>–í–æ–ø—Ä–æ—Å <span id="current-question">1</span> –∏–∑ <span id="total-questions">20</span></span>
        <span id="progress-percent">5%</span>
      </div>
    </div>
    
    <div id="quiz"></div>
    
    <div class="buttons">
      <button id="submitBtn">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –æ—Ç–≤–µ—Ç—ã</button>
      <button id="resetBtn">–ù–∞—á–∞—Ç—å –∑–∞–Ω–æ–≤–æ</button>
    </div>
    
    <div class="result" id="result"></div>
  </div>

<script>
const questions = [
  {
    question: "–ù–∞–π—Ç–∏ \\( y' \\), –µ—Å–ª–∏ \\( y = (3x^2 + 2x)^5 \\)",
    options: [
      "30x(3x^2+2x)^4 + 10(3x^2+2x)^4",
      "10x(3x^2+2x)^4",
      "6x(3x^2+2x)^5",
      "(3x^2+2x)^5"
    ],
    answer: 0,
    explanation: "–ò—Å–ø–æ–ª—å–∑—É–µ–º –ø—Ä–∞–≤–∏–ª–æ —Ü–µ–ø–∏: \\( y' = 5(3x^2+2x)^4 \\cdot (6x+2) = (30x+10)(3x^2+2x)^4 \\)."
  },
  {
    question: "–ù–∞–π—Ç–∏ \\( y' \\), –µ—Å–ª–∏ \\( y = \\sin(5x) \\)",
    options: [
      "\\( 5\\cos(5x) \\)",
      "\\( \\cos(5x) \\)",
      "\\( 5\\sin(5x) \\)",
      "\\( -5\\cos(5x) \\)"
    ],
    answer: 0,
    explanation: "–ü—Ä–æ–∏–∑–≤–æ–¥–Ω–∞—è \\( \\sin(u) = u'\\cos(u) \\). –ó–¥–µ—Å—å \\( u=5x, u'=5 \\). –û—Ç–≤–µ—Ç: \\( 5\\cos(5x) \\)."
  },
  {
    question: "–ù–∞–π—Ç–∏ \\( y' \\), –µ—Å–ª–∏ \\( y = e^{2x^2} \\)",
    options: [
      "\\( 4xe^{2x^2} \\)",
      "\\( 2e^{2x^2} \\)",
      "\\( e^{2x^2} \\)",
      "\\( 2x e^{2x^2} \\)"
    ],
    answer: 0,
    explanation: "–ü—Ä–∞–≤–∏–ª–æ —Ü–µ–ø–∏: \\( (e^u)' = u'e^u \\). –ó–¥–µ—Å—å \\( u=2x^2, u'=4x \\). –û—Ç–≤–µ—Ç: \\( 4xe^{2x^2} \\)."
  },
  {
    question: "–ù–∞–π—Ç–∏ \\( y' \\), –µ—Å–ª–∏ \\( y = \\ln(1+x^3) \\)",
    options: [
      "\\( \\frac{3x^2}{1+x^3} \\)",
      "\\( \\frac{1}{1+x^3} \\)",
      "\\( 3x^2 \\)",
      "\\( \\frac{1}{x^3} \\)"
    ],
    answer: 0,
    explanation: "–ü—Ä–æ–∏–∑–≤–æ–¥–Ω–∞—è \\( \\ln(u) = u'/u \\). –ó–¥–µ—Å—å \\( u=1+x^3, u'=3x^2 \\). –û—Ç–≤–µ—Ç: \\( 3x^2/(1+x^3) \\)."
  },
  {
    question: "–ù–∞–π—Ç–∏ \\( y' \\), –µ—Å–ª–∏ \\( y = (\\cos x)^3 \\)",
    options: [
      "\\( -3\\cos^2(x)\\sin(x) \\)",
      "\\( 3\\cos^2(x)\\sin(x) \\)",
      "\\( \\cos^3(x) \\)",
      "\\( -\\sin(x) \\)"
    ],
    answer: 0,
    explanation: "–ü—Ä–∞–≤–∏–ª–æ —Ü–µ–ø–∏: \\( y' = 3(\\cos x)^2(-\\sin x) = -3\\cos^2(x)\\sin(x) \\)."
  },
  {
    question: "–ù–∞–π—Ç–∏ \\( y' \\), –µ—Å–ª–∏ \\( y = (x^2+1)^7 \\)",
    options: [
      "\\( 14x(x^2+1)^6 \\)",
      "\\( 7(x^2+1)^6 \\)",
      "\\( 14(x^2+1)^7 \\)",
      "\\( 2x(x^2+1)^7 \\)"
    ],
    answer: 0,
    explanation: "–ü—Ä–∞–≤–∏–ª–æ —Ü–µ–ø–∏: \\( y' = 7(x^2+1)^6(2x) = 14x(x^2+1)^6 \\)."
  },
  {
    question: "–ù–∞–π—Ç–∏ \\( y' \\), –µ—Å–ª–∏ \\( y = \\sqrt{1-2x} \\)",
    options: [
      "\\( -\\frac{1}{\\sqrt{1-2x}} \\)",
      "\\( \\frac{1}{2\\sqrt{1-2x}} \\)",
      "\\( -\\frac{1}{2\\sqrt{1-2x}} \\)",
      "\\( -2\\sqrt{1-2x} \\)"
    ],
    answer: 2,
    explanation: "–ü—Ä–µ–¥—Å—Ç–∞–≤–∏–º: \\( y=(1-2x)^{1/2} \\). –ü—Ä–æ–∏–∑–≤–æ–¥–Ω–∞—è: \\( y' = \\frac{1}{2}(1-2x)^{-1/2}(-2) = -1/(2\\sqrt{1-2x}) \\)."
  },
  {
    question: "–ù–∞–π—Ç–∏ \\( y' \\), –µ—Å–ª–∏ \\( y = \\arctan(3x) \\)",
    options: [
      "\\( \\frac{3}{1+9x^2} \\)",
      "\\( \\frac{1}{1+9x^2} \\)",
      "\\( \\frac{3}{1+x^2} \\)",
      "\\( \\frac{1}{1+x^2} \\)"
    ],
    answer: 0,
    explanation: "–ü—Ä–∞–≤–∏–ª–æ: \\( (\\arctan u)' = u'/(1+u^2) \\). –ó–¥–µ—Å—å \\( u=3x, u'=3 \\). –û—Ç–≤–µ—Ç: \\( 3/(1+9x^2) \\)."
  },
  {
    question: "–ù–∞–π—Ç–∏ \\( y' \\), –µ—Å–ª–∏ \\( y = \\ln(\\sin x) \\)",
    options: [
      "\\( \\cot(x) \\)",
      "\\( \\tan(x) \\)",
      "\\( \\cos(x) \\)",
      "\\( 1/\\sin(x) \\)"
    ],
    answer: 0,
    explanation: "–ü—Ä–æ–∏–∑–≤–æ–¥–Ω–∞—è: \\( (\\ln u)' = u'/u \\). –ó–¥–µ—Å—å \\( u=\\sin x, u'=\\cos x \\). –ü–æ–ª—É—á–∞–µ–º \\( y' = \\cos x/\\sin x = \\cot x \\)."
  },
  {
    question: "–ù–∞–π—Ç–∏ \\( y' \\), –µ—Å–ª–∏ \\( y = (2x+5)^4 \\)",
    options: [
      "\\( 8(2x+5)^3 \\)",
      "\\( 4(2x+5)^3 \\)",
      "\\( 2(2x+5)^4 \\)",
      "\\( (2x+5)^4 \\)"
    ],
    answer: 0,
    explanation: "–ü—Ä–∞–≤–∏–ª–æ —Ü–µ–ø–∏: \\( y' = 4(2x+5)^3 \\cdot 2 = 8(2x+5)^3 \\)."
  },
  {
    question: "–ù–∞–π—Ç–∏ \\( y' \\), –µ—Å–ª–∏ \\( y = e^{\\sin x} \\)",
    options: [
      "\\( \\cos(x)e^{\\sin x} \\)",
      "\\( e^{\\sin x} \\)",
      "\\( -\\sin(x)e^{\\sin x} \\)",
      "\\( e^{x}\\cos x \\)"
    ],
    answer: 0,
    explanation: "–ü—Ä–æ–∏–∑–≤–æ–¥–Ω–∞—è: \\( (e^u)' = u'e^u \\). –ó–¥–µ—Å—å \\( u=\\sin x, u'=\\cos x \\). –û—Ç–≤–µ—Ç: \\( \\cos(x)e^{\\sin x} \\)."
  },
  {
    question: "–ù–∞–π—Ç–∏ \\( y' \\), –µ—Å–ª–∏ \\( y = (x^3+2x)^2 \\)",
    options: [
      "\\( (3x^2+2)(2x^3+4x) \\)",
      "\\( 2(x^3+2x)(3x^2+2) \\)",
      "\\( 2(x^3+2x) \\)",
      "\\( (3x^2+2)(x^3+2x)^2 \\)"
    ],
    answer: 1,
    explanation: "–ü—Ä–∞–≤–∏–ª–æ —Ü–µ–ø–∏: \\( y' = 2(x^3+2x)(3x^2+2) \\)."
  },
  {
    question: "–ù–∞–π—Ç–∏ \\( y' \\), –µ—Å–ª–∏ \\( y = \\cos(\\sqrt{x}) \\)",
    options: [
      "\\( -\\frac{1}{2\\sqrt{x}}\\sin(\\sqrt{x}) \\)",
      "\\( -\\sin(\\sqrt{x}) \\)",
      "\\( \\sin(\\sqrt{x}) \\)",
      "\\( -\\frac{1}{\\sqrt{x}}\\cos(\\sqrt{x}) \\)"
    ],
    answer: 0,
    explanation: "–ü—Ä–∞–≤–∏–ª–æ —Ü–µ–ø–∏: \\( y' = -\\sin(\\sqrt{x}) \\cdot (1/(2\\sqrt{x})) \\)."
  },
  {
    question: "–ù–∞–π—Ç–∏ \\( y' \\), –µ—Å–ª–∏ \\( y = (\\tan x)^2 \\)",
    options: [
      "\\( 2\\tan(x)\\sec^2(x) \\)",
      "\\( 2\\sec^2(x) \\)",
      "\\( \\tan^2(x) \\)",
      "\\( \\sec^2(x) \\)"
    ],
    answer: 0,
    explanation: "–ü—Ä–æ–∏–∑–≤–æ–¥–Ω–∞—è: \\( y' = 2\\tan(x)\\cdot (\\tan x)' = 2\\tan(x)\\sec^2(x) \\)."
  },
  {
    question: "–ù–∞–π—Ç–∏ \\( y' \\), –µ—Å–ª–∏ \\( y = \\ln(2x^2+1) \\)",
    options: [
      "\\( \\frac{4x}{2x^2+1} \\)",
      "\\( \\frac{1}{2x^2+1} \\)",
      "\\( \\frac{2}{2x^2+1} \\)",
      "\\( 4x \\)"
    ],
    answer: 0,
    explanation: "–ü—Ä–∞–≤–∏–ª–æ —Ü–µ–ø–∏: \\( (\\ln u)' = u'/u \\). –ó–¥–µ—Å—å \\( u=2x^2+1, u'=4x \\). –û—Ç–≤–µ—Ç: \\( 4x/(2x^2+1) \\)."
  },
  {
    question: "–ù–∞–π—Ç–∏ \\( y' \\), –µ—Å–ª–∏ \\( y = e^{\\tan x} \\)",
    options: [
      "\\( e^{\\tan x}\\sec^2(x) \\)",
      "\\( e^{\\tan x}\\tan(x) \\)",
      "\\( \\sec^2(x) \\)",
      "\\( e^x\\tan(x) \\)"
    ],
    answer: 0,
    explanation: "–ü—Ä–∞–≤–∏–ª–æ —Ü–µ–ø–∏: \\( y' = (\\tan x)' e^{\\tan x} = \\sec^2(x)e^{\\tan x} \\)."
  },
  {
    question: "–ù–∞–π—Ç–∏ \\( y' \\), –µ—Å–ª–∏ \\( y = \\sqrt{\\ln x} \\)",
    options: [
      "\\( \\frac{1}{2x\\sqrt{\\ln x}} \\)",
      "\\( \\frac{1}{x} \\)",
      "\\( \\frac{1}{2\\sqrt{\\ln x}} \\)",
      "\\( \\frac{\\ln x}{2x} \\)"
    ],
    answer: 0,
    explanation: "–ü—Ä–∞–≤–∏–ª–æ —Ü–µ–ø–∏: \\( y=(\\ln x)^{1/2} \\). –ü—Ä–æ–∏–∑–≤–æ–¥–Ω–∞—è: \\( y' = (1/2)(\\ln x)^{-1/2}(1/x) = 1/(2x\\sqrt{\\ln x}) \\)."
  },
  {
    question: "–ù–∞–π—Ç–∏ \\( y' \\), –µ—Å–ª–∏ \\( y = \\sin(x^2) \\)",
    options: [
      "\\( 2x\\cos(x^2) \\)",
      "\\( \\cos(x^2) \\)",
      "\\( 2\\sin(x^2) \\)",
      "\\( x\\sin(x^2) \\)"
    ],
    answer: 0,
    explanation: "–ü—Ä–∞–≤–∏–ª–æ —Ü–µ–ø–∏: \\( (\\sin u)' = u'\\cos u \\). –ó–¥–µ—Å—å \\( u=x^2, u'=2x \\). –û—Ç–≤–µ—Ç: \\( 2x\\cos(x^2) \\)."
  },
  {
    question: "–ù–∞–π—Ç–∏ \\( y' \\), –µ—Å–ª–∏ \\( y = (1+e^x)^5 \\)",
    options: [
      "\\( 5(1+e^x)^4 e^x \\)",
      "\\( 5(1+e^x)^5 \\)",
      "\\( (1+e^x)^4 \\)",
      "\\( e^x(1+e^x)^5 \\)"
    ],
    answer: 0,
    explanation: "–ü—Ä–∞–≤–∏–ª–æ —Ü–µ–ø–∏: \\( y' = 5(1+e^x)^4 (e^x) \\)."
  },
  {
    question: "–ù–∞–π—Ç–∏ \\( y' \\), –µ—Å–ª–∏ \\( y = \\cos(3x^2) \\)",
    options: [
      "\\( -6x\\sin(3x^2) \\)",
      "\\( -3\\sin(3x^2) \\)",
      "\\( -6\\sin(x^2) \\)",
      "\\( -3x\\cos(3x^2) \\)"
    ],
    answer: 0,
    explanation: "–ü—Ä–∞–≤–∏–ª–æ —Ü–µ–ø–∏: \\( y' = -\\sin(3x^2)\\cdot(6x) = -6x\\sin(3x^2) \\)."
  }
];

  // –ü–µ—Ä–µ–º–µ—à–∏–≤–∞–Ω–∏–µ –≤–æ–ø—Ä–æ—Å–æ–≤
  function shuffleArray(array) {
    for (let i = array.length - 1; i > 0; i--) {
      const j = Math.floor(Math.random() * (i + 1));
      [array[i], array[j]] = [array[j], array[i]];
    }
  }

  shuffleArray(questions);

  const quizContainer = document.getElementById('quiz');
  const resultDiv = document.getElementById('result');
  const submitBtn = document.getElementById('submitBtn');
  const resetBtn = document.getElementById('resetBtn');
  const progressBar = document.getElementById('progress');
  const currentQuestionElement = document.getElementById('current-question');
  const totalQuestionsElement = document.getElementById('total-questions');
  const progressPercentElement = document.getElementById('progress-percent');
  const timerDisplay = document.getElementById('timer');

  let currentQuestion = 1;
  const totalQuestions = questions.length;
  totalQuestionsElement.textContent = totalQuestions;

  // –¢–∞–π–º–µ—Ä –Ω–∞ 40 –º–∏–Ω—É—Ç (2400 —Å–µ–∫—É–Ω–¥)
  let timeLeft = 40 * 60;
  let timerInterval;

  function formatTime(seconds) {
    const m = String(Math.floor(seconds / 60)).padStart(2, '0');
    const s = String(seconds % 60).padStart(2, '0');
    return `${m}:${s}`;
  }

  function startTimer() {
    clearInterval(timerInterval);
    timeLeft = 40 * 60;
    timerDisplay.textContent = formatTime(timeLeft);
    timerDisplay.classList.remove('timer-warning');
    
    timerInterval = setInterval(() => {
      timeLeft--;
      timerDisplay.textContent = formatTime(timeLeft);
      
      // –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Ü–≤–µ—Ç–∞ –ø—Ä–∏ –º–∞–ª–æ–º –æ—Å—Ç–∞–≤—à–µ–º—Å—è –≤—Ä–µ–º–µ–Ω–∏
      if (timeLeft <= 300) { // 5 –º–∏–Ω—É—Ç
        timerDisplay.classList.add('timer-warning');
      }
      
      if (timeLeft <= 0) {
        clearInterval(timerInterval);
        finishQuiz();
      }
    }, 1000);
  }

  function updateProgress() {
    const progress = (currentQuestion / totalQuestions) * 100;
    progressBar.style.width = `${progress}%`;
    progressPercentElement.textContent = `${Math.round(progress)}%`;
    currentQuestionElement.textContent = currentQuestion;
  }

  // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –≤–æ–ø—Ä–æ—Å–æ–≤
  function generateQuiz() {
    quizContainer.innerHTML = '';
    currentQuestion = 1;
    updateProgress();
    
    questions.forEach((q, i) => {
      const div = document.createElement('div');
      div.className = 'question';
      div.innerHTML = `
        <p><strong>–í–æ–ø—Ä–æ—Å ${i + 1}:</strong> ${q.question}</p>
        <div class="options">
          ${q.options.map((opt, idx) => `
            <div class="option" data-index="${idx}">
              <input type="radio" name="q${i}" id="q${i}_${idx}" value="${idx}">
              <label for="q${i}_${idx}">${opt}</label>
            </div>
          `).join('')}
        </div>
      `;
      quizContainer.appendChild(div);
    });

    // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ –æ—Ç–≤–µ—Ç–æ–≤
    document.querySelectorAll('.option').forEach(option => {
      option.addEventListener('click', function() {
        const questionDiv = this.closest('.question');
        const inputs = questionDiv.querySelectorAll('input[type="radio"]');
        const options = questionDiv.querySelectorAll('.option');
        
        // –°–Ω–∏–º–∞–µ–º –≤—ã–¥–µ–ª–µ–Ω–∏–µ —Å–æ –≤—Å–µ—Ö –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤
        options.forEach(opt => opt.classList.remove('selected'));
        
        // –í—ã–¥–µ–ª—è–µ–º –≤—ã–±—Ä–∞–Ω–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç
        this.classList.add('selected');
        
        // –û—Ç–º–µ—á–∞–µ–º —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π —Ä–∞–¥–∏–æ-–∏–Ω–ø—É—Ç
        const input = this.querySelector('input');
        input.checked = true;
        
        // –û–±–Ω–æ–≤–ª—è–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å
        const answeredQuestions = document.querySelectorAll('.question').length - 
                                 document.querySelectorAll('.question:not(:has(input:checked))').length;
        currentQuestion = answeredQuestions + 1;
        updateProgress();
      });
    });

    // MathJax
    if (window.MathJax) {
      MathJax.typesetPromise();
    }
  }

  // –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ —Ç–µ—Å—Ç–∞
  submitBtn.addEventListener('click', finishQuiz);
  
  // –ö–Ω–æ–ø–∫–∞ —Å–±—Ä–æ—Å–∞
  resetBtn.addEventListener('click', function() {
    resultDiv.style.display = 'none';
    generateQuiz();
    startTimer();
  });

  // –§—É–Ω–∫—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Ç–µ—Å—Ç–∞
  function finishQuiz() {
    clearInterval(timerInterval);
    
    let score = 0;
    let resultsHTML = '';

    questions.forEach((q, i) => {
      const selected = document.querySelector(`input[name="q${i}"]:checked`);
      const isCorrect = selected && parseInt(selected.value) === q.answer;
      
      if (isCorrect) {
        score++;
      }
      
      // –ö—Ä–∞—Å–∏–≤–æ–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ —Å –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–º–∏ –≤—ã—Ä–∞–∂–µ–Ω–∏—è–º–∏
      resultsHTML += `
        <div class="result-item ${isCorrect ? 'correct' : 'incorrect'}">
          <p><strong>–í–æ–ø—Ä–æ—Å ${i + 1}:</strong> ${q.question}</p>
          
          <div class="user-answer">
            <span class="answer-icon ${isCorrect ? 'correct-icon' : 'incorrect-icon'}">${isCorrect ? '‚úì' : '‚úó'}</span>
            <span>–í–∞—à –æ—Ç–≤–µ—Ç: </span>
            <div class="math-expression">${selected ? q.options[selected.value] : '–ù–µ—Ç –æ—Ç–≤–µ—Ç–∞'}</div>
          </div>
      `;
      
      if (!isCorrect) {
        resultsHTML += `
          <div class="correct-answer">
            <span class="answer-icon correct-icon">‚úì</span>
            <span>–ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç: </span>
            <div class="math-expression">${q.options[q.answer]}</div>
          </div>
        `;
      }
      
      resultsHTML += `
          <p class="explanation">${q.explanation}</p>
        </div>
      `;
    });

    let feedback = '';
    if (score >= 9) {
      feedback = "üåü –ü–æ—Ç—Ä—è—Å–∞—é—â–µ! –í—ã –º–∞—Å—Ç–µ—Ä –¥–∏—Ñ—Ñ–µ—Ä–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–≥–æ –∏—Å—á–∏—Å–ª–µ–Ω–∏—è! –û—Ç–ª–∏—á–Ω–æ–µ –ø–æ–Ω–∏–º–∞–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–Ω—ã—Ö —Å–ª–æ–∂–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π.";
    } else if (score >= 7) {
      feedback = "üëç –û—á–µ–Ω—å —Ö–æ—Ä–æ—à–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç! –í—ã —Ö–æ—Ä–æ—à–æ —Ä–∞–∑–±–∏—Ä–∞–µ—Ç–µ—Å—å –≤ —Ç–µ–º–µ, –Ω–æ –µ—Å—Ç—å –∫—É–¥–∞ —Ä–∞—Å—Ç–∏.";
    } else if (score >= 5) {
      feedback = "üìö –ù–µ–ø–ª–æ—Ö–æ! –í—ã –ø–æ–Ω–∏–º–∞–µ—Ç–µ –æ—Å–Ω–æ–≤—ã, –Ω–æ –Ω—É–∂–Ω–æ –±–æ–ª—å—à–µ –ø—Ä–∞–∫—Ç–∏–∫–∏ —Å —Å–ª–æ–∂–Ω—ã–º–∏ —Ñ—É–Ω–∫—Ü–∏—è–º–∏.";
    } else {
      feedback = "üí™ –°—Ç–æ–∏—Ç –ø–æ–≤—Ç–æ—Ä–∏—Ç—å –º–∞—Ç–µ—Ä–∏–∞–ª. –û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ –ø—Ä–∞–≤–∏–ª–æ —Ü–µ–ø–∏ –∏ –ø—Ä–æ–∏–∑–≤–æ–¥–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç–∞—Ä–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π.";
    }

    resultDiv.innerHTML = `
      <div class="score">–†–µ–∑—É–ª—å—Ç–∞—Ç: ${score} –∏–∑ ${questions.length}</div>
      <div class="feedback">${feedback}</div>
      <div class="detailed-results">
        <h3>–ü–æ–¥—Ä–æ–±–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã:</h3>
        ${resultsHTML}
      </div>
    `;
    
    resultDiv.style.display = 'block';
    resultDiv.classList.add('fade-in');

    // –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –≤—Å–µ—Ö —Ä–∞–¥–∏–æ-–∫–Ω–æ–ø–æ–∫
    document.querySelectorAll('input[type="radio"]').forEach(input => {
      input.disabled = true;
    });

    // –î–µ–∞–∫—Ç–∏–≤–∞—Ü–∏—è –∫–Ω–æ–ø–∫–∏ –æ—Ç–ø—Ä–∞–≤–∫–∏
    submitBtn.disabled = true;
    submitBtn.innerText = '–¢–µ—Å—Ç –∑–∞–≤–µ—Ä—à—ë–Ω';
    submitBtn.style.backgroundColor = '#ccc';
    submitBtn.style.cursor = 'not-allowed';
    
    // –ü–µ—Ä–µ—Ä–∏—Å–æ–≤–∫–∞ –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö –≤—ã—Ä–∞–∂–µ–Ω–∏–π –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞—Ö
    if (window.MathJax) {
      MathJax.typesetPromise();
    }
    
    // –ü—Ä–æ–∫—Ä—É—Ç–∫–∞ –∫ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º
    resultDiv.scrollIntoView({ behavior: 'smooth' });
  }

  // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
  generateQuiz();
  startTimer();
</script>

</body>
</html>